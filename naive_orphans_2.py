from parse import get_lines, parse_line, get_data
from rdf import TYPE, LABEL, RELATES, RELATED_BY, NUM_LINES
from utils import get_obj, transpose_dict

relates = get_obj('naive_orphans_relates.pkl')
related_by = get_obj('naive_orphans_related_by.pkl')

print(transpose_dict(relates))
"""
{0: 2603084, 2: 593313, 1: 11732, 5: 12483, 4: 4965, 6: 1021, 14: 77, 10: 280, 7: 2910, 15: 30, 9: 397, 3: 725, 8: 684, 13: 57, 37: 1, 12: 103, 11: 163, 31: 3, 16: 26, 22: 9, 17: 26, 28: 5, 18: 19, 26: 4, 66: 1, 32: 4, 33: 2, 19: 14, 21: 11, 42: 3, 54: 3, 35: 2, 20: 15, 43: 2, 46: 3, 103: 1, 27: 3, 36: 4, 24: 6, 23: 6, 53: 1, 30: 3, 50: 1, 25: 7, 38: 3, 68: 1, 57: 1, 29: 5, 45: 1, 58: 1, 41: 1, 56: 1, 158: 1, 65: 1, 44: 1, 55: 1, 95: 1, 49: 2, 48: 1, 39: 2, 83: 1, 51: 1, 306: 1, 34: 1, 52: 1, 60: 1, 67: 1, 82: 1, 106: 1}
"""

print(transpose_dict(related_by))

"""
{0: 2723832, 1: 392514, 2: 31626, 5: 10386, 10: 3062, 3: 19140, 11: 1773, 4: 13797, 14: 1052, 7: 5735, 8: 4570, 9: 4517, 6: 8215, 37: 64, 16: 766, 12: 1666, 17: 502, 13: 1115, 18: 571, 27: 166, 23: 218, 72: 17, 21: 288, 22: 326, 64: 25, 30: 141, 101: 7, 15: 740, 34: 114, 19: 347, 113: 8, 153: 3, 29: 150, 58: 25, 39: 91, 282: 1, 20: 393, 331: 2, 31: 109, 36: 105, 50: 450, 24: 281, 28: 185, 53: 39, 46: 62, 107: 13, 54: 38, 62: 26, 26: 208, 41: 64, 25: 214, 76: 20, 45: 54, 47: 47, 48: 65, 52: 50, 42: 66, 49: 53, 44: 74, 88: 11, 3385: 1, 87: 14, 169: 3, 33: 98, 95: 5, 32: 117, 69: 23, 40: 79, 78: 23, 217: 2, 99: 4, 38: 97, 266: 1, 1253: 1, 105: 9, 57: 34, 35: 80, 139: 9, 327: 2, 51: 194, 158: 7, 75: 17, 435: 2, 77: 21, 91: 16, 67: 22, 142: 5, 114: 4, 410: 2, 68: 32, 61: 18, 724: 1, 881: 1, 43: 52, 273: 3, 100: 64, 90: 13, 718: 1, 281: 1, 66: 23, 204: 1, 63: 25, 257: 1, 220: 4, 60: 30, 125: 5, 70: 16, 71: 25, 164: 2, 85: 13, 65: 18, 96: 9, 55: 49, 138: 2, 150: 10, 122: 3, 82: 24, 73: 14, 134: 6, 97: 6, 396: 2, 207: 2, 648: 1, 80: 14, 175: 1, 205: 2, 120: 7, 154: 2, 369: 2, 356: 2, 83: 10, 108: 4, 79: 13, 106: 10, 237: 3, 188: 4, 104: 13, 74: 13, 2171: 1, 121: 3, 147: 5, 320: 1, 456: 1, 56: 43, 187: 4, 360: 1, 564: 1, 2234: 1, 167: 6, 186: 2, 84: 12, 183: 2, 315: 1, 573: 1, 93: 12, 170: 2, 115: 8, 218: 4, 314: 1, 111: 10, 443: 2, 272: 2, 584: 2, 151: 2, 522: 1, 298: 1, 81: 8, 571: 1, 393: 1, 98: 7, 202: 2, 680: 1, 133: 4, 194: 3, 59: 26, 128: 7, 633: 1, 117: 5, 109: 9, 262: 1, 94: 5, 124: 5, 270: 3, 250: 1, 146: 5, 203: 3, 182: 2, 233: 2, 129: 4, 201: 2, 401: 2, 373: 3, 86: 15, 92: 7, 319: 1, 485: 1, 2204: 1, 177: 1, 159: 4, 132: 3, 118: 5, 574: 1, 155: 3, 385: 1, 609: 1, 362: 2, 702: 1, 720: 1, 137: 3, 444: 1, 163: 3, 197: 2, 543: 1, 317: 2, 2449: 1, 136: 4, 542: 1, 103: 7, 347: 1, 131: 6, 2232: 2, 368: 1, 366: 1, 219: 2, 152: 3, 172: 4, 141: 3, 181: 4, 112: 3, 126: 5, 359: 1, 160: 3, 123: 3, 243: 2, 199: 1, 284: 3, 102: 8, 156: 3, 166: 5, 271: 3, 110: 5, 148: 4, 144: 5, 1716: 1, 639: 1, 116: 9, 216: 2, 256: 1, 249: 1, 225: 2, 1434: 1, 190: 1, 176: 3, 286: 1, 380: 1, 241: 3, 996: 1, 89: 6, 127: 2, 180: 4, 189: 2, 363: 1, 255: 2, 390: 1, 214: 2, 2268: 1, 210: 2, 520: 1, 211: 1, 193: 2, 232: 1, 606: 1, 173: 1, 206: 2, 341: 2, 140: 2, 195: 2, 168: 2, 191: 1, 2229: 1, 446: 1, 375: 1, 244: 1, 409: 1, 196: 1, 405: 1, 2272: 1, 215: 1, 200: 5, 947: 1, 221: 1, 534: 1, 185: 1, 145: 1, 292: 1, 321: 1, 527: 1, 407: 1, 394: 1, 238: 1, 149: 2, 465: 1, 384: 1, 429: 2, 644: 1, 259: 2, 264: 1, 208: 2, 439: 1, 679: 1, 692: 1, 358: 1, 287: 2, 130: 1, 300: 1, 165: 3, 269: 1, 2193: 1, 213: 1, 119: 2, 294: 1, 318: 1, 815: 1, 411: 1, 422: 1, 184: 3, 157: 1, 423: 1, 305: 1, 576: 1, 355: 1, 230: 2, 386: 1, 248: 1, 408: 1, 616: 1, 1087: 1, 1295: 1, 1116: 1, 526: 1, 437: 1, 252: 1, 290: 1, 799: 1, 278: 1, 553: 1, 171: 1, 161: 1, 1211: 1, 2220: 1, 361: 1, 260: 1, 918: 1, 2368: 1, 242: 1, 1009: 1, 387: 1, 959: 1, 915: 1, 135: 1, 768: 1, 827: 1, 703: 1, 847: 1, 492: 1, 2219: 1, 222: 1, 143: 1, 376: 1, 1410: 1}
"""

for s, p, o in map(parse_line, get_data()):
    if p == LABEL and related_by[s] == 0:
        print(s, o)